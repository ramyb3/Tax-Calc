<!DOCTYPE html>
<html dir="rtl" lang="he">
  
    <head>

        <link rel="stylesheet" href="styles.css">

        <meta name="viewport" content="width=device-width, initial-scale=0.75">
        
        <title>מחשבון מיסים לשנת 2022</title>

    </head>

    <script>

        function calc()
        {
            let x= parseFloat(document.getElementById('1').value);
            let y= parseFloat(document.getElementById('2').value);
            let z= parseFloat(document.getElementById('3').value);

            if(document.getElementById('1').value=='' || document.getElementById('2').value=='' || document.getElementById('3').value=='')
            alert('צריך למלא את כל השדות!');

            else
            {
                ////////////////////////////////////////////////////////////////////////////

                let total=0; // IRS payment
                
                if(y>6450)
                total =6450*0.1;

                else
                total =y*0.1;
            
                if(y>6450)
                {
                    if(y>9240)
                    total += (9240-6451)*0.14;

                    else
                    total += (y-6451)*0.14;
                }

                if(y>9240)
                {
                    if(y>14840)
                    total += (14840-9241)*0.2;

                    else
                    total += (y-9241)*0.2;
                }

                if(y>14840)
                {
                    if(y>20620)
                    total += (20620-14841)*0.31;

                    else
                    total += (y-14841)*0.31;
                }

                if(y>20620)
                {
                    if(y>42910)
                    total += (42910-20621)*0.35;

                    else
                    total += (y-20621)*0.35;
                }

                if(y>42910)
                {
                    if(y>55270)
                    total += ((55270-42911)*0.47) + ((y-55271)*0.5);

                    else
                    total += (y-42911)*0.47;
                }

                total= (total-(223*x)).toFixed(2);

                if(total<0)
                total=0;

                ////////////////////////////////////////////////////////////////////////////

                let health=0, social=0;

                if(z>6331)
                {
                    if(z<45076)
                    {
                        health= ((z-6331)*0.05) + (6331*0.031);
                        social= ((z-6331)*0.07) + (6331*0.004);
                    }

                    else
                    {
                        health= ((45075-6331)*0.05) + (6331*0.031);
                        social= ((45075-6331)*0.07) + (6331*0.004);
                    }
                }

                else
                {
                    health= z*0.031;
                    social= z*0.004;
                }

                health= health.toFixed(2);
                social= social.toFixed(2);

                ////////////////////////////////////////////////////////////////////////////

                document.getElementById('show').style.visibility= 'visible';

                document.getElementById('4').innerHTML='תשלום לביטוח לאומי: ' + social + '₪';
                document.getElementById('5').innerHTML='תשלום לביטוח בריאות: ' + health + '₪';
                document.getElementById('6').innerHTML='תשלום למס הכנסה: ' + total + '₪';

                total= (parseFloat(health)+parseFloat(social)+parseFloat(total)).toFixed(2);

                document.getElementById('7').innerHTML='סה"כ ניכויים: ' + total + '₪';
            }
        }

        function help(x)
        {
            if(x==1 && document.getElementById('counter1').value=='0')
            {
                document.getElementById('counter1').value= '1';
                alert('משכורת ברוטו המצויינת בתלוש (ברוטו למס הכנסה)');
            }

            if(x==2 && document.getElementById('counter2').value=='0')
            {
                document.getElementById('counter2').value= '1';
                alert('משכורת ברוטו לביטוח לאומי (המצויינת בצד התלוש)');
            }
        }
        
    </script>

    <body>

        <h1>מחשבון מיסים לחודשי 2022</h1>

        <input id="1" placeholder="הכנס כמות נקודות זיכוי" type="text"><br><br>
        <input onfocus="help(1)" id="2" placeholder="הכנס משכורת ברוטו למס הכנסה" type="text"><br><br>
        <input onfocus="help(2)" id="3" placeholder="הכנס משכורת ברוטו לביטוח " type="text"><br><br>

        <input id="button" style="cursor: pointer; width: min-content;" type="button" value="חשב מיסים" onclick="calc()"><br><br>

        <input id='counter1' type="hidden" value='0'>
        <input id='counter2' type="hidden" value='0'>

        <script>

            var input = document.getElementById("3");

            input.addEventListener("keyup", function(event)
            {
                if (event.keyCode === 13)
                {
                    event.preventDefault();
                    document.getElementById("button").click();
                }
            });

        </script>

        <div id="show" style="color: rgb(13, 17, 255); font-size: 25px; visibility: hidden;"><b>

            <div id="4"></div><br>
            <div id="5"></div><br>
            <div id="6"></div><br>
            <div id="7"></div><br>

        </b></div>

    </body>

</html>
